#!/usr/bin/perl
@input = <STDIN>;

$pattern = $ARGV[0];
$gcommand = $ARGV[1];
$lines = @input;
# Iterate the lines from the input
for($t = 0; $t < $lines; $t++){
	$command = $gcommand;
	$input[$t] =~ qr/$pattern/;
	$count = @-;
	# Replace %0 with the entire string
	$command =~ s/\%0/$input[$t]/;
	# Iterate the matches from the pattern
	for($i = 1; $i < $count; $i++){
		# Extract the match and build the command string
		$arg = ${$i};
		$cmdarg = "\%" . $i;
		# Replace $cmdarg (should be %1, %2, etc) with $arg (whatever data was extracted from the match)
		$command =~ s/$cmdarg/$arg/g;
	}
	# Execute the command for this line
	system $command;
}
